---
title: ä½¿ç”¨Gradioæ„å»ºäº¤äº’å¼Webåº”ç”¨-P5
subtitle: ä½¿ç”¨Gradioæ„å»ºäº¤äº’å¼åœ°å›¾åº”ç”¨
author: 
  - "äºå³»å·"
date: "2025-4-30"
categories:
  - Posts
  - Gradio
  - APP
  - Deep learning
image: https://dunazo.oss-cn-beijing.aliyuncs.com/blog/Gradio_11.png
toc: true
---

# ä½¿ç”¨Gradioæ„å»ºäº¤äº’å¼Webåº”ç”¨

<br><br>
è¿™æ˜¯ä¸€ä¸ªå…³äºå¦‚ä½•ä½¿ç”¨ Gradio æ„å»º Web åº”ç”¨ç¨‹åºçš„å¼€æºç³»åˆ—æ•™ç¨‹ã€‚ä½ å°†ä»è®¾ç½® Python ç¯å¢ƒå¼€å§‹ï¼Œå­¦ä¹ æ–‡æœ¬ã€å›¾åƒç­‰å„ç±»è¾“å…¥ç»„ä»¶ï¼Œè‡ªå®šä¹‰ç•Œé¢ï¼Œè®¾è®¡å¤æ‚çš„äº¤äº’ç­‰ã€‚æœ¬è¯¾ç¨‹è¿˜å°†æ¶µç›–ä½¿ç”¨ Gradio å’Œ GDAL å¤„ç†é¥æ„Ÿæ•°æ®ï¼Œç”¨äºå›¾åƒå¢å¼ºã€åœ°ç†åæ ‡è½¬æ¢ã€å¡åº¦åˆ†æç­‰ä»»åŠ¡ï¼›å­¦ä¹ å¦‚ä½•ä½¿ç”¨ Gradio å’Œ Foliumap åˆ›å»ºäº¤äº’å¼åœ°å›¾ï¼Œå®ç°åŠ¨æ€åœ°ç†ç©ºé—´æ•°æ®å¯è§†åŒ–ï¼›å¦‚ä½•é›†æˆæœºå™¨å­¦ä¹ æ¨¡å‹å¹¶åœ¨ Hugging Face Spaces ä¸Šå‘å¸ƒ web åº”ç”¨ç¨‹åºã€‚æœ¬æ•™ç¨‹åŒ…æ‹¬å®ä¾‹ã€æ¼”ç¤ºå’Œä½œä¸šã€‚å®Œæˆæœ¬æ•™ç¨‹åï¼Œä½ å°†èƒ½å¤Ÿé«˜æ•ˆåœ°æ„å»ºã€éƒ¨ç½²å’Œå…±äº«äº¤äº’å¼ Web åº”ç”¨ç¨‹åºã€‚
è¯¾ç¨‹ç›¸å…³é…å¥—è¯·åœ¨æ–‡æœ«è·å–ã€‚

<br><br>

## Part5 ï¼šä½¿ç”¨Gradioæ„å»ºäº¤äº’å¼åœ°å›¾åº”ç”¨

<br><br>

### DEMO 5-1: äº¤äº’åœ°å›¾æ¡†æ¶æ„å»ºä¸åæ ‡å®šä½

<br><br>

å°†åæ ‡èŒƒå›´æˆ–å½±åƒæ˜¾ç¤ºåœ¨åœ°å›¾ä¸­æ˜¯é¥æ„Ÿå¤„ç†çš„å¸¸è§„æ“ä½œã€‚Gradioä¸­è™½ç„¶æ²¡æœ‰ç›´æ¥æä¾›ç›¸åº”çš„æ§ä»¶ï¼Œä½†å¯ä»¥å€ŸåŠ©Leafmapä¸­çš„Foliumç­‰å®ç°äº¤äº’å¼åœ°å›¾çš„æ„å»º.æœ¬æ¡ˆä¾‹ä¸­ä¸»è¦å‘ˆç°å«æœ‰åœ¨çº¿å½±åƒçš„åº•å›¾æ¡†æ¶çš„æ„å»ºä»¥åŠåæ ‡çš„å®šä½ã€‚

- **Leafmap** (leafmap.org) æ˜¯ä¸€ä¸ªä¸“ä¸ºäº¤äº’å¼åœ°ç†ç©ºé—´åˆ†æå’Œå¯è§†åŒ–è®¾è®¡çš„Pythonåº“ï¼Œç”±å´ç§‹ç”Ÿè€å¸ˆåˆ›å»ºã€‚å®ƒæ•´åˆäº†å¤šä¸ªæµè¡Œå·¥å…·ï¼ˆå¦‚ Foliumã€ipyleaflet å’Œ Google Earth Engineï¼‰ï¼Œç®€åŒ–äº†åœ°ç†æ•°æ®å¤„ç†å’Œåœ°å›¾åˆ›å»ºçš„æµç¨‹ã€‚
- **åœ°å›¾æ¡†æ¶** èƒ½å¤Ÿå®ç°åœ¨Gradioä¸­å‘ˆç°åŠ¨æ€åœ°å›¾çš„å…³é”®åœ¨äºï¼Œé€šè¿‡leafmapçš„to_gradioå‡½æ•°å°†åœ°å›¾è½¬ä¸ºGradioå¯æ¥æ”¶çš„Htmlæ ¼å¼ï¼Œä»è€Œå®ç°åœ°å›¾æ¡†æ¶çš„æ„å»ºã€‚

<br><br>

```python
import gradio as gr
import leafmap.foliumap as leafmap

# å®šä¹‰ä¸€ä¸ªæ ¹æ®å‚æ•°ç”Ÿæˆåœ°å›¾çš„å‡½æ•°
def generate_map(zoom_level, maptype="Esri.WorldStreetMap", coordsy='', coordsx=''):
    if coordsy == '' and coordsx == '':
        coordsy = 40   # é»˜è®¤çº¬åº¦åæ ‡
        coordsx = 116.3  # é»˜è®¤ç»åº¦åæ ‡
    print(maptype)

    # ä½¿ç”¨leafmapåˆ›å»ºåœ°å›¾å¯¹è±¡ï¼ŒæŒ‡å®šä¸­å¿ƒç‚¹å’Œç¼©æ”¾çº§åˆ«
    map = leafmap.Map(location=(coordsy, coordsx), zoom=zoom_level)
    map.add_basemap(maptype)  # æ·»åŠ æŒ‡å®šçš„åº•å›¾ç±»å‹
    return map.to_gradio()    # è¿”å›HTMLæ ¼å¼çš„åœ°å›¾

# åˆ›å»ºGradioç•Œé¢
with gr.Blocks() as demo:
    # é¡¶éƒ¨æ ‡é¢˜
    gr.HTML("""
            <center> 
            <h1> General a map ğŸ—ºï¸ </h1>
            <b> jason.yu.mail@qq.com  ğŸ“§<b>
            </center>
            """)      
    with gr.Row():
      with gr.Row():
        # ç»çº¬åº¦è¾“å…¥æ¡†
        coordinates_input_y = gr.Textbox(value='',placeholder=40,label="ä¸­å¿ƒç‚¹çº¬åº¦",lines=1)
        coordinates_input_x = gr.Textbox(value='',placeholder=116.3,label="ä¸­å¿ƒç‚¹ç»åº¦",lines=1)
        # ç¼©æ”¾çº§åˆ«æ»‘å—
        zoom_level_input = gr.Slider(value=9,minimum=4,maximum=15,step=1,label="é€‰æ‹©ç¼©æ”¾çº§åˆ«",interactive=True)

    with gr.Row():
      # åº•å›¾ç±»å‹ä¸‹æ‹‰èœå•
      maptype=gr.Dropdown(
              choices=[
                  "Esri.NatGeoWorldMap",
                  "Esri.WorldGrayCanvas",
                  "Esri.WorldImagery",
                  "Esri.WorldShadedRelief",
                  "Esri.WorldStreetMap",
                  "Esri.WorldTerrain",
                  "Esri.WorldTopoMap",
              ],value="Esri.WorldStreetMap",interactive=True,label="åº•å›¾ç±»å‹")
      # ç”Ÿæˆåœ°å›¾æŒ‰é’®
      map_button = gr.Button("ç”Ÿæˆåœ°å›¾",scale=1)
    with gr.Row():
      # åœ°å›¾è¾“å‡ºåŒºåŸŸ
      map_output = gr.HTML() 

    # æŒ‰é’®ç‚¹å‡»äº‹ä»¶ç»‘å®š
    map_button.click(generate_map, inputs=[zoom_level_input,maptype,coordinates_input_y,coordinates_input_x], outputs=[map_output])

# å¯åŠ¨å¤šçº¿ç¨‹å¤„ç†æ¨¡å¼
demo.queue().launch() 

# infile='iputfile'
# path='https://github.com/JunchuanYu/Gradio_tutorial/blob/main/data/raster.tif'

```

![](https://dunazo.oss-cn-beijing.aliyuncs.com/blog/demo5-1.gif)




### DEMO 5-2: Tiffæ–‡ä»¶çš„äº‘ç«¯å¯è§†åŒ–

<br><br>

æ …æ ¼æ•°æ®çš„ç±»å‹æ˜¯å¤šæ ·çš„ï¼Œç”±äºGradioæ„å»ºçš„äº¤äº’å¼åº”ç”¨æ˜¯ä¾æ‰˜Webæ„å»ºçš„ï¼Œå› æ­¤Tifféœ€è¦è½¬ä¸ºæ …æ ¼åˆ‡ç‰‡æœåŠ¡æ‰èƒ½æ­£ç¡®çš„å‘ˆç°åœ¨åœ°å›¾ä¸­ã€‚æœ¬æ¡ˆä¾‹ä¸­ä»¥ä¿å­˜åœ¨é¡¹ç›®ç›®å½•ä¸‹çš„â€œinput.tifâ€å’Œä¿å­˜åœ¨ç½‘ç»œçš„â€œhttps://github.com/JunchuanYu/Gradio_tutorial/blob/main/data/raster.tifâ€çš„å¯è§†åŒ–ä¸ºä¾‹è¿›è¡Œè¯´æ˜ã€‚

- **åœ¨çº¿åº•å›¾** Foliumä¸­æ”¯æŒåœ¨çº¿åœ°å›¾ç“¦ç‰‡çš„åŠ è½½ï¼Œé™¤äº†esriã€arcgisã€googleä¹‹å¤–ä¹Ÿæ”¯æŒå¤©åœ°å›¾ç­‰å›½äº§æ•°æ®ã€‚
- **æœ¬åœ°Tiff** å…¶å¯è§†åŒ–è¿‡ç¨‹æ˜¯å°†Tiffè½¬ä¸ºæœ¬åœ°çš„ç“¦ç‰‡å›¾å±‚å†å åŠ åˆ°åº•å›¾ä¸­ã€‚
- **äº‘ç«¯Tiff** æœ¬æ¡ˆä¾‹ä¸­çš„äº‘ç«¯Tiffæ˜¯å…ˆä¸‹è½½åˆ°æœ¬åœ°åå†è¿›è¡Œå¯è§†åŒ–çš„ï¼Œæ­¤å¤–ï¼Œå¯ä»¥é‡‡ç”¨add_remote_tile å‡½æ•°ç”¨äºåŠ è½½ Cloud Optimized GeoTIFF (COG) æ ¼å¼çš„è¿œç¨‹ TIFF æ–‡ä»¶ç›´æ¥åŠ è½½ã€‚

<br><br>

```python
import gradio as gr
import leafmap.foliumap as leafmap

# å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºåœ¨leafmapä¸­åŠ è½½Tiffæ–‡ä»¶
def showtiff(text1, text2):
    infile = str(text1)  # è½¬æ¢ä¸ºå­—ç¬¦ä¸²æ ¼å¼
    filepath = str(text2)  # è½¬æ¢ä¸ºå­—ç¬¦ä¸²æ ¼å¼
    
    # åˆ›å»ºåœ°å›¾å¯¹è±¡
    Map = leafmap.Map()
    
    # æ·»åŠ é»˜è®¤åº•å›¾
    Map.add_tile_layer(
        infile='https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}',
        name='arcgisonline',
        attribution='attribution'
    )
    
    # å¦‚æœinfileä¸ä¸ºç©ºï¼Œåˆ™æ·»åŠ ç“¦ç‰‡å›¾å±‚
    if infile != '':
        Map.add_raster(infile)
    
    # å¦‚æœæ–‡ä»¶è·¯å¾„ä¸ä¸ºç©ºï¼Œåˆ™ä¸‹è½½å¹¶æ·»åŠ Tiffæ–‡ä»¶
    if filepath != '':
        raster = "raster.tif"
        raster = leafmap.download_file(filepath, "raster.tif")
        Map.add_raster(raster, layer_name='insar')
    
    return Map.to_gradio()

# åˆ›å»ºGradioç•Œé¢
with gr.Blocks(theme='gradio/soft') as demo:
    # é¡µé¢æ ‡é¢˜
    gr.HTML("""
            <center> 
            <h1> ä½¿ç”¨foliumapå¤„ç†åœ°å›¾æ•°æ® ğŸ—ºï¸ </h1>
            <b> jason.yu.mail@qq.com  ğŸ“§<b>
            </center>
            """)
    
    # è¾“å…¥è¡Œ
    with gr.Row():
        input = gr.Textbox(label='è¾“å…¥æœ¬åœ°Tiffæ–‡ä»¶å', interactive=True)
        input2 = gr.Textbox(label='è¾“å…¥Tiffæ–‡ä»¶URL', interactive=True)
    
    # è¾“å‡ºè¡Œ
    with gr.Row():
        out = gr.HTML()
    
    # ç»‘å®šäº‹ä»¶å¤„ç†
    input.change(showtiff, inputs=[input, input2], outputs=out)
    input2.change(showtiff, inputs=[input, input2], outputs=out)

# å¯åŠ¨åº”ç”¨
demo.launch(debug=True)

```

<br><br>

![](https://dunazo.oss-cn-beijing.aliyuncs.com/blog/newdemo5-2.gif)



ä¸Šä¸€ç¯‡å…³äºDEMO4-2çš„æ–‡ç« é“¾æ¥ï¼š


---------------------------
è¯·å…³æ³¨å¾®ä¿¡å…¬ä¼—å·ã€45åº¦ç§‘ç ”äººã€‘å›å¤â€œ**@gradio**â€è·å–è¯¥æ•™ç¨‹é…å¥—æ•°æ®ï¼Œæ¬¢è¿åå°ç•™è¨€ï¼


<span style="display: block; text-align: center; margin-left: auto; margin-right: auto;">
    <img src="https://dunazo.oss-cn-beijing.aliyuncs.com/blog/wechat-simple.png" width="200"  alt="">
</span>


